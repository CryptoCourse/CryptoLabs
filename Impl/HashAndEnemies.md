Стойоксть современных хэш-функций часто основывается на предположении об их стойкости к нахождению коллизий.

Пусть `H: {0,1}^* -> {0,1}^n` функция, переводящая множество двоичных векторов произвольной длины 
в множество векторов фиксированной длины `n`. `n` называется размеров выхода хэш-функции `H`.

Хэш-функция `H` назвается стойкой к коллизиям второго рода, если вычислительно сложно найти такую пару `(x,y) \in {0,1}^* :
x != y, H(x) = H(y).

Очевидно, что даже для "идеальной" хэш-функции (т.е. хэш функции, на которую не существуют атак лучше перебора)
существуют коллизии, из-за разности мощностей множества прообразов и множества образов хэш-функции.

Рассмотрим атаку на основе так называемого пародокса дней рождений. 

```
0. S <- пустое множество.
1. Выбрать случайный элемент x из {0,1}^*
2. Вычислить значение h_x = H(x)
3. Проверить, есть ли в множестве S элемент (y, h_x). Если есть => goto DONE
4. Добавить элемент (x, h_x) в множество S
5. goto 1
DONE:
6. Вернуть пару (x, y) как коллизию хэш-функции.
```
 
Данная атака на некоторую стойкую к коллизиям хэш-функцию `H: {0,1}^* -> {0,1}^n` имеет вычислительную сложность `O(2^(n/2))` и 
требует O(2^(n/2)) памяти.

Рассмотрим атаку на основе Ро.

Пусть имеется m потоков выполнения программы. Пусть Pi : {0,1}^a -> {0,1}^(a+k) - инъективная функция: x |-> x || 0^k, 
где 0^k - нулевой двоичный вектор длины k. q=b/2 - log_2(m). `H: {0,1}^* -> {0,1}^b`

Каждый поток выполняет следующий алгоритм:

```
0. S <- пустое множество.
```

```
1. y_i = Pi(H(y_{i-1})
2. Если y_i != 0^q || yr_i: goto 1
3. Если (z_j, j) : z_j == y_i, для любого j находится в S: goto FOUND
4. Добавить (y_i, i) в S
5. goto 1
FOUND: 
6. Пусть i>z. Вычислить d = i-z
7. Вычислить y = H^d(y), z = z
8. Если H(y) = H(z): вернуть (y,z) как коллизию хэш-функции.
9. (y, z) = (H(y), H(z))
10. goto 8
```

Данная атака имеет вычислительную сложность O(2^{b/2}/m) и O(m) памяти.


https://crypto.stackexchange.com/questions/52231/what-is-the-best-and-fastest-algorithm-to-generate-a-hash-collision
https://cr.yp.to/hash/collisioncost-20090517.pdf
